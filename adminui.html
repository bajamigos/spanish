<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Antonimo Admin Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>Antonimo Admin Dashboard</h1>

  <div class="admin-dashboard">
    <div class="admin-card">
      <h2>Upload / Replace CSV</h2>
      <input type="file" id="csvUpload" accept=".csv">
      <button id="csvUploadBtn">Upload CSV</button>
      <table class="csv-preview-table" id="csvPreview"></table>
    </div>

    <div class="admin-card">
      <h2>Upload / Replace Flashcard-data.csv</h2>
      <input type="file" id="flashcardUpload" accept=".csv">
      <button id="flashcardUploadBtn">Upload CSV</button>
      <table class="csv-preview-table" id="flashcardPreview"></table>
    </div>

    <div class="admin-card">
      <h2>Upload / Replace wordladder.csv</h2>
      <input type="file" id="wordladderUpload" accept=".csv">
      <button id="wordladderUploadBtn">Upload CSV</button>
      <table class="csv-preview-table" id="wordladderPreview"></table>
    </div>

    <div class="admin-card">
      <h2>Upload / Replace wordhunt.csv</h2>
      <input type="file" id="wordhuntUpload" accept=".csv">
      <button id="wordhuntUploadBtn">Upload CSV</button>
      <table class="csv-preview-table" id="wordhuntPreview"></table>
    </div>

    <div class="admin-card">
      <h2>Upload / Replace placeholder.csv</h2>
      <input type="file" id="placeholderUpload" accept=".csv">
      <button id="placeholderUploadBtn">Upload CSV</button>
      <table class="csv-preview-table" id="placeholderPreview"></table>
    </div>

    <div class="admin-card">
      <h2>Upload / Replace monologue-ideas.csv</h2>
      <input type="file" id="monologueUpload" accept=".csv">
      <button id="monologueUploadBtn">Upload CSV</button>
      <table class="csv-preview-table" id="monologuePreview"></table>
    </div>

    <div class="admin-card">
      <h2>Upload / Replace Debate-topics.csv</h2>
      <input type="file" id="debateUpload" accept=".csv">
      <button id="debateUploadBtn">Upload CSV</button>
      <table class="csv-preview-table" id="debatePreview"></table>
    </div>

    <div class="admin-card">
      <h2>Upload / Replace Rollplay-ideas.csv</h2>
      <input type="file" id="rollplayUpload" accept=".csv">
      <button id="rollplayUploadBtn">Upload CSV</button>
      <table class="csv-preview-table" id="rollplayPreview"></table>
    </div>

    <div class="admin-card">
      <h2>Upload / Replace Podcast-ideas.csv</h2>
      <input type="file" id="podcastUpload" accept=".csv">
      <button id="podcastUploadBtn">Upload CSV</button>
      <table class="csv-preview-table" id="podcastPreview"></table>
    </div>

    <div class="admin-card">
      <h2>User Management</h2>
      <input type="text" id="userSearch" placeholder="Enter user email">
      <button id="resetUserBtn">Reset User Progress</button>
      <div id="userActionMsg"></div>
    </div>

    <div class="admin-card">
      <h2>Stats Overview</h2>
      <div class="admin-stats">
        <div class="stat-box" id="totalUsers">Users: --</div>
        <div class="stat-box" id="activeUsers">Active (7d): --</div>
        <div class="stat-box" id="totalReviews">Reviews: --</div>
        <div class="stat-box" id="avgEF">Avg EF: --</div>
        <div class="stat-box" id="cardsAdded">Cards This Week: --</div>
      </div>
    </div>
  </div>

  <img src="antonimo-logo.jpg" alt="Antonimo logo" class="logo-bg">

  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore-compat.js"></script>

  <script>
  const firebaseConfig = {
    apiKey: "AIzaSyDJYgI-xgZAGj6780W8BqXS4thd8ODvfDA",
    authDomain: "antonimo-acbd9.firebaseapp.com",
    projectId: "antonimo-acbd9",
    storageBucket: "antonimo-acbd9.firebasestorage.app",
    messagingSenderId: "904238822187",
    appId: "1:904238822187:web:2c0488369954495f3b8b6e",
    measurementId: "G-GTP9X49KNP"
  };
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Dummy safe preview (no writes yet)
  document.getElementById('csvUploadBtn').onclick = async () => {
    const file = document.getElementById('csvUpload').files[0];
    if (!file) return alert('Select a CSV first!');
    const text = await file.text();
    const [header, ...rows] = text.split('\n').filter(Boolean);
    const headers = header.split(',');
    const table = document.getElementById('csvPreview');
    table.innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>' +
      rows.slice(0, 5).map(r => `<tr>${r.split(',').map(c => `<td>${c}</td>`).join('')}</tr>`).join('');
  };

  // Duplicate dummy previews for added sections (no actual uploads)
  document.getElementById('flashcardUploadBtn').onclick = async () => {
    const file = document.getElementById('flashcardUpload').files[0];
    if (!file) return alert('Select a CSV first!');
    const text = await file.text();
    const [header, ...rows] = text.split('\n').filter(Boolean);
    const headers = header.split(',');
    const table = document.getElementById('flashcardPreview');
    table.innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>' +
      rows.slice(0, 5).map(r => `<tr>${r.split(',').map(c => `<td>${c}</td>`).join('')}</tr>`).join('');
  };

  document.getElementById('wordladderUploadBtn').onclick = async () => {
    const file = document.getElementById('wordladderUpload').files[0];
    if (!file) return alert('Select a CSV first!');
    const text = await file.text();
    const [header, ...rows] = text.split('\n').filter(Boolean);
    const headers = header.split(',');
    const table = document.getElementById('wordladderPreview');
    table.innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>' +
      rows.slice(0, 5).map(r => `<tr>${r.split(',').map(c => `<td>${c}</td>`).join('')}</tr>`).join('');
  };

  document.getElementById('wordhuntUploadBtn').onclick = async () => {
    const file = document.getElementById('wordhuntUpload').files[0];
    if (!file) return alert('Select a CSV first!');
    const text = await file.text();
    const [header, ...rows] = text.split('\n').filter(Boolean);
    const headers = header.split(',');
    const table = document.getElementById('wordhuntPreview');
    table.innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>' +
      rows.slice(0, 5).map(r => `<tr>${r.split(',').map(c => `<td>${c}</td>`).join('">}</tr>`).join('');
  };

  document.getElementById('placeholderUploadBtn').onclick = async () => {
    const file = document.getElementById('placeholderUpload').files[0];
    if (!file) return alert('Select a CSV first!');
    const text = await file.text();
    const [header, ...rows] = text.split('\n').filter(Boolean);
    const headers = header.split(',');
    const table = document.getElementById('placeholderPreview');
    table.innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>' +
      rows.slice(0, 5).map(r => `<tr>${r.split(',').map(c => `<td>${c}</td>`).join('')}</tr>`).join('');
  };

  document.getElementById('monologueUploadBtn').onclick = async () => {
    const file = document.getElementById('monologueUpload').files[0];
    if (!file) return alert('Select a CSV first!');
    const text = await file.text();
    const [header, ...rows] = text.split('\n').filter(Boolean);
    const headers = header.split(',');
    const table = document.getElementById('monologuePreview');
    table.innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>' +
      rows.slice(0, 5).map(r => `<tr>${r.split(',').map(c => `<td>${c}</td>`).join('')}</tr>`).join('');
  };

  document.getElementById('debateUploadBtn').onclick = async () => {
    const file = document.getElementById('debateUpload').files[0];
    if (!file) return alert('Select a CSV first!');
    const text = await file.text();
    const [header, ...rows] = text.split('\n').filter(Boolean);
    const headers = header.split(',');
    const table = document.getElementById('debatePreview');
    table.innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>' +
      rows.slice(0, 5).map(r => `<tr>${r.split(',').map(c => `<td>${c}</td>`).join('">}</tr>`).join('');
  };

  document.getElementById('rollplayUploadBtn').onclick = async () => {
    const file = document.getElementById('rollplayUpload').files[0];
    if (!file) return alert('Select a CSV first!');
    const text = await file.text();
    const [header, ...rows] = text.split('\n').filter(Boolean);
    const headers = header.split(',');
    const table = document.getElementById('rollplayPreview');
    table.innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>' +
      rows.slice(0, 5).map(r => `<tr>${r.split(',').map(c => `<td>${c}</td>`).join('">}</tr>`).join('');
  };

  document.getElementById('podcastUploadBtn').onclick = async () => {
    const file = document.getElementById('podcastUpload').files[0];
    if (!file) return alert('Select a CSV first!');
    const text = await file.text();
    const [header, ...rows] = text.split('\n').filter(Boolean);
    const headers = header.split(',');
    const table = document.getElementById('podcastPreview');
    table.innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>' +
      rows.slice(0, 5).map(r => `<tr>${r.split(',').map(c => `<td>${c}</td>`).join('">}</tr>`).join('');
  };

  async function loadStats() {
    const usersSnap = await db.collection('users').get();
    document.getElementById('totalUsers').textContent = `Users: ${usersSnap.size}`;
  }
  loadStats();
  </script>
</body>
</html>
